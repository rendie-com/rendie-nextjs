<table class='tb'>
  <tr class="thead">               
    <td colspan="2">编辑定时任务</td>
  </tr>
  <r:task where=" where @.id=<.arr(4)/>"
  <tr>               
    <td align='right'>任务名称:</td>
    <td><input type="text" id="TaskName" value="[task:name]" size="50"> 如:定时生成首页</td>
  </tr>
  <tr>               
  <td align='right'>可执行任务:</td>
  <td>
    <input type="text" id="TaskURL" value="[task:url]" size="100"><br/>
    如:/admin/Default.aspx
  </td>
  </tr>
  <tr class='tdbg'>               
    <td align='right'>执行周期:</td>
    <td>
      <select id="starttype" >
      <option value="1" {if [task:starttype]==1} selected{/if}>每天</option>
      <option value="2" {if [task:starttype]==2} selected{/if}>每周</option>
      <option value="3" {if [task:starttype]==3} selected{/if}>按时间段</option>
      </select>
      <span id="weekarea" {if [task:starttype]!=2}style='display:none'{/if}>
      <select id="week" >
      <option value="1" {if [task:week]==1} selected{/if}>星期一</option>
      <option value="2" {if [task:week]==2} selected{/if}>星期二</option>
      <option value="3" {if [task:week]==3} selected{/if}>星期三</option>
      <option value="4" {if [task:week]==4} selected{/if}>星期四</option>
      <option value="5" {if [task:week]==5} selected{/if}>星期五</option>
      <option value="6" {if [task:week]==6} selected{/if}>星期六</option>
      <option value="7" {if [task:week]==7} selected{/if}>星期日</option>
      </select> 
      </span>
    </td>
  </tr>
  <tr>               
    <td align='right'>执行时间:</td>
    <td>
    <select id="time" {if [task:starttype]==3}multiple="multiple" style="width:200px;height:150px"</if> >
    <option value="0:00" <if "[task:time]".indexOf("0:00")!=-1} selected{/if}>0点00分</option>
    <option value="0:10" <if "[task:time]".indexOf("0:10")!=-1} selected{/if}>0点10分</option>
    <option value="0:20" <if "[task:time]".indexOf("0:20")!=-1} selected{/if}>0点20分</option>
    <option value="0:30" <if "[task:time]".indexOf("0:30")!=-1} selected{/if}>0点30分</option>
    <option value="0:40" <if "[task:time]".indexOf("0:40")!=-1} selected{/if}>0点40分</option>
    <option value="0:50" <if "[task:time]".indexOf("0:50")!=-1} selected{/if}>0点50分</option>
    <option value="1:00" <if "[task:time]".indexOf("1:00")!=-1} selected{/if}>1点00分</option>
    <option value="1:10" <if "[task:time]".indexOf("1:10")!=-1} selected{/if}>1点10分</option>
    <option value="1:20" <if "[task:time]".indexOf("1:20")!=-1} selected{/if}>1点20分</option>
    <option value="1:30" <if "[task:time]".indexOf("1:30")!=-1} selected{/if}>1点30分</option>
    <option value="1:40" <if "[task:time]".indexOf("1:40")!=-1} selected{/if}>1点40分</option>
    <option value="1:50" <if "[task:time]".indexOf("1:50")!=-1} selected{/if}>1点50分</option>
    <option value="2:00" <if "[task:time]".indexOf("2:00")!=-1} selected{/if}>2点00分</option>
    <option value="2:10" <if "[task:time]".indexOf("2:10")!=-1} selected{/if}>2点10分</option>
    <option value="2:20" <if "[task:time]".indexOf("2:20")!=-1} selected{/if}>2点20分</option>
    <option value="2:30" <if "[task:time]".indexOf("2:30")!=-1} selected{/if}>2点30分</option>
    <option value="2:40" <if "[task:time]".indexOf("2:40")!=-1} selected{/if}>2点40分</option>
    <option value="2:50" <if "[task:time]".indexOf("2:50")!=-1} selected{/if}>2点50分</option>
    <option value="3:00" <if "[task:time]".indexOf("3:00")!=-1} selected{/if}>3点00分</option>
    <option value="3:10" <if "[task:time]".indexOf("3:10")!=-1} selected{/if}>3点10分</option>
    <option value="3:20" <if "[task:time]".indexOf("3:20")!=-1} selected{/if}>3点20分</option>
    <option value="3:30" <if "[task:time]".indexOf("3:30")!=-1} selected{/if}>3点30分</option>
    <option value="3:40" <if "[task:time]".indexOf("3:40")!=-1} selected{/if}>3点40分</option>
    <option value="3:50" <if "[task:time]".indexOf("3:50")!=-1} selected{/if}>3点50分</option>
    <option value="4:00" <if "[task:time]".indexOf("4:00")!=-1} selected{/if}>4点00分</option>
    <option value="4:10" <if "[task:time]".indexOf("4:10")!=-1} selected{/if}>4点10分</option>
    <option value="4:20" <if "[task:time]".indexOf("4:20")!=-1} selected{/if}>4点20分</option>
    <option value="4:30" <if "[task:time]".indexOf("4:30")!=-1} selected{/if}>4点30分</option>
    <option value="4:40" <if "[task:time]".indexOf("4:40")!=-1} selected{/if}>4点40分</option>
    <option value="4:50" <if "[task:time]".indexOf("4:50")!=-1} selected{/if}>4点50分</option>
    <option value="5:00" <if "[task:time]".indexOf("5:00")!=-1} selected{/if}>5点00分</option>
    <option value="5:10" <if "[task:time]".indexOf("5:10")!=-1} selected{/if}>5点10分</option>
    <option value="5:20" <if "[task:time]".indexOf("5:20")!=-1} selected{/if}>5点20分</option>
    <option value="5:30" <if "[task:time]".indexOf("5:30")!=-1} selected{/if}>5点30分</option>
    <option value="5:40" <if "[task:time]".indexOf("5:40")!=-1} selected{/if}>5点40分</option>
    <option value="5:50" <if "[task:time]".indexOf("5:50")!=-1} selected{/if}>5点50分</option>
    <option value="6:00" <if "[task:time]".indexOf("6:00")!=-1} selected{/if}>6点00分</option>
    <option value="6:10" <if "[task:time]".indexOf("6:10")!=-1} selected{/if}>6点10分</option>
    <option value="6:20" <if "[task:time]".indexOf("6:20")!=-1} selected{/if}>6点20分</option>
    <option value="6:30" <if "[task:time]".indexOf("6:30")!=-1} selected{/if}>6点30分</option>
    <option value="6:40" <if "[task:time]".indexOf("6:40")!=-1} selected{/if}>6点40分</option>
    <option value="6:50" <if "[task:time]".indexOf("6:50")!=-1} selected{/if}>6点50分</option>
    <option value="7:00" <if "[task:time]".indexOf("7:00")!=-1} selected{/if}>7点00分</option>
    <option value="7:10" <if "[task:time]".indexOf("7:10")!=-1} selected{/if}>7点10分</option>
    <option value="7:20" <if "[task:time]".indexOf("7:20")!=-1} selected{/if}>7点20分</option>
    <option value="7:30" <if "[task:time]".indexOf("7:30")!=-1} selected{/if}>7点30分</option>
    <option value="7:40" <if "[task:time]".indexOf("7:40")!=-1} selected{/if}>7点40分</option>
    <option value="7:50" <if "[task:time]".indexOf("7:50")!=-1} selected{/if}>7点50分</option>
    <option value="8:00" <if "[task:time]".indexOf("8:00")!=-1} selected{/if}>8点00分</option>
    <option value="8:10" <if "[task:time]".indexOf("8:10")!=-1} selected{/if}>8点10分</option>
    <option value="8:20" <if "[task:time]".indexOf("8:20")!=-1} selected{/if}>8点20分</option>
    <option value="8:30" <if "[task:time]".indexOf("8:30")!=-1} selected{/if}>8点30分</option>
    <option value="8:40" <if "[task:time]".indexOf("8:40")!=-1} selected{/if}>8点40分</option>
    <option value="8:50" <if "[task:time]".indexOf("8:50")!=-1} selected{/if}>8点50分</option>
    <option value="9:00" <if "[task:time]".indexOf("9:00")!=-1} selected{/if}>9点00分</option>
    <option value="9:10" <if "[task:time]".indexOf("9:10")!=-1} selected{/if}>9点10分</option>
    <option value="9:20" <if "[task:time]".indexOf("9:20")!=-1} selected{/if}>9点20分</option>
    <option value="9:30" <if "[task:time]".indexOf("9:30")!=-1} selected{/if}>9点30分</option>
    <option value="9:40" <if "[task:time]".indexOf("9:40")!=-1} selected{/if}>9点40分</option>
    <option value="9:50" <if "[task:time]".indexOf("9:50")!=-1} selected{/if}>9点50分</option>
    <option value="10:00" <if "[task:time]".indexOf("10:00")!=-1} selected{/if}>10点00分</option>
    <option value="10:10" <if "[task:time]".indexOf("10:10")!=-1} selected{/if}>10点10分</option>
    <option value="10:20" <if "[task:time]".indexOf("10:20")!=-1} selected{/if}>10点20分</option>
    <option value="10:30" <if "[task:time]".indexOf("10:30")!=-1} selected{/if}>10点30分</option>
    <option value="10:40" <if "[task:time]".indexOf("10:40")!=-1} selected{/if}>10点40分</option>
    <option value="10:50" <if "[task:time]".indexOf("10:50")!=-1} selected{/if}>10点50分</option>
    <option value="11:00" <if "[task:time]".indexOf("11:00")!=-1} selected{/if}>11点00分</option>
    <option value="11:10" <if "[task:time]".indexOf("11:10")!=-1} selected{/if}>11点10分</option>
    <option value="11:20" <if "[task:time]".indexOf("11:20")!=-1} selected{/if}>11点20分</option>
    <option value="11:30" <if "[task:time]".indexOf("11:30")!=-1} selected{/if}>11点30分</option>
    <option value="11:40" <if "[task:time]".indexOf("11:40")!=-1} selected{/if}>11点40分</option>
    <option value="11:50" <if "[task:time]".indexOf("11:50")!=-1} selected{/if}>11点50分</option>
    <option value="12:00" <if "[task:time]".indexOf("12:00")!=-1} selected{/if}>12点00分</option>
    <option value="12:10" <if "[task:time]".indexOf("12:10")!=-1} selected{/if}>12点10分</option>
    <option value="12:20" <if "[task:time]".indexOf("12:20")!=-1} selected{/if}>12点20分</option>
    <option value="12:30" <if "[task:time]".indexOf("12:30")!=-1} selected{/if}>12点30分</option>
    <option value="12:40" <if "[task:time]".indexOf("12:40")!=-1} selected{/if}>12点40分</option>
    <option value="12:50" <if "[task:time]".indexOf("12:50")!=-1} selected{/if}>12点50分</option>
    <option value="13:00" <if "[task:time]".indexOf("13:00")!=-1} selected{/if}>13点00分</option>
    <option value="13:10" <if "[task:time]".indexOf("13:10")!=-1} selected{/if}>13点10分</option>
    <option value="13:20" <if "[task:time]".indexOf("13:20")!=-1} selected{/if}>13点20分</option>
    <option value="13:30" <if "[task:time]".indexOf("13:30")!=-1} selected{/if}>13点30分</option>
    <option value="13:40" <if "[task:time]".indexOf("13:40")!=-1} selected{/if}>13点40分</option>
    <option value="13:50" <if "[task:time]".indexOf("13:50")!=-1} selected{/if}>13点50分</option>
    <option value="14:00" <if "[task:time]".indexOf("14:00")!=-1} selected{/if}>14点00分</option>
    <option value="14:10" <if "[task:time]".indexOf("14:10")!=-1} selected{/if}>14点10分</option>
    <option value="14:20" <if "[task:time]".indexOf("14:20")!=-1} selected{/if}>14点20分</option>
    <option value="14:30" <if "[task:time]".indexOf("14:30")!=-1} selected{/if}>14点30分</option>
    <option value="14:40" <if "[task:time]".indexOf("14:40")!=-1} selected{/if}>14点40分</option>
    <option value="14:50" <if "[task:time]".indexOf("14:50")!=-1} selected{/if}>14点50分</option>
    <option value="15:00" <if "[task:time]".indexOf("15:00")!=-1} selected{/if}>15点00分</option>
    <option value="15:10" <if "[task:time]".indexOf("15:10")!=-1} selected{/if}>15点10分</option>
    <option value="15:20" <if "[task:time]".indexOf("15:20")!=-1} selected{/if}>15点20分</option>
    <option value="15:30" <if "[task:time]".indexOf("15:30")!=-1} selected{/if}>15点30分</option>
    <option value="15:40" <if "[task:time]".indexOf("15:40")!=-1} selected{/if}>15点40分</option>
    <option value="15:50" <if "[task:time]".indexOf("15:50")!=-1} selected{/if}>15点50分</option>
    <option value="16:00" <if "[task:time]".indexOf("16:00")!=-1} selected{/if}>16点00分</option>
    <option value="16:10" <if "[task:time]".indexOf("16:10")!=-1} selected{/if}>16点10分</option>
    <option value="16:20" <if "[task:time]".indexOf("16:20")!=-1} selected{/if}>16点20分</option>
    <option value="16:30" <if "[task:time]".indexOf("16:30")!=-1} selected{/if}>16点30分</option>
    <option value="16:40" <if "[task:time]".indexOf("16:40")!=-1} selected{/if}>16点40分</option>
    <option value="16:50" <if "[task:time]".indexOf("16:50")!=-1} selected{/if}>16点50分</option>
    <option value="17:00" <if "[task:time]".indexOf("17:00")!=-1} selected{/if}>17点00分</option>
    <option value="17:10" <if "[task:time]".indexOf("17:10")!=-1} selected{/if}>17点10分</option>
    <option value="17:20" <if "[task:time]".indexOf("17:20")!=-1} selected{/if}>17点20分</option>
    <option value="17:30" <if "[task:time]".indexOf("17:30")!=-1} selected{/if}>17点30分</option>
    <option value="17:40" <if "[task:time]".indexOf("17:40")!=-1} selected{/if}>17点40分</option>
    <option value="17:50" <if "[task:time]".indexOf("17:50")!=-1} selected{/if}>17点50分</option>
    <option value="18:00" <if "[task:time]".indexOf("18:00")!=-1} selected{/if}>18点00分</option>
    <option value="18:10" <if "[task:time]".indexOf("18:10")!=-1} selected{/if}>18点10分</option>
    <option value="18:20" <if "[task:time]".indexOf("18:20")!=-1} selected{/if}>18点20分</option>
    <option value="18:30" <if "[task:time]".indexOf("18:30")!=-1} selected{/if}>18点30分</option>
    <option value="18:40" <if "[task:time]".indexOf("18:40")!=-1} selected{/if}>18点40分</option>
    <option value="18:50" <if "[task:time]".indexOf("18:50")!=-1} selected{/if}>18点50分</option>
    <option value="19:00" <if "[task:time]".indexOf("19:00")!=-1} selected{/if}>19点00分</option>
    <option value="19:10" <if "[task:time]".indexOf("19:10")!=-1} selected{/if}>19点10分</option>
    <option value="19:20" <if "[task:time]".indexOf("19:20")!=-1} selected{/if}>19点20分</option>
    <option value="19:30" <if "[task:time]".indexOf("19:30")!=-1} selected{/if}>19点30分</option>
    <option value="19:40" <if "[task:time]".indexOf("19:40")!=-1} selected{/if}>19点40分</option>
    <option value="19:50" <if "[task:time]".indexOf("19:50")!=-1} selected{/if}>19点50分</option>
    <option value="20:00" <if "[task:time]".indexOf("20:00")!=-1} selected{/if}>20点00分</option>
    <option value="20:10" <if "[task:time]".indexOf("20:10")!=-1} selected{/if}>20点10分</option>
    <option value="20:20" <if "[task:time]".indexOf("20:20")!=-1} selected{/if}>20点20分</option>
    <option value="20:30" <if "[task:time]".indexOf("20:30")!=-1} selected{/if}>20点30分</option>
    <option value="20:40" <if "[task:time]".indexOf("20:40")!=-1} selected{/if}>20点40分</option>
    <option value="20:50" <if "[task:time]".indexOf("20:50")!=-1} selected{/if}>20点50分</option>
    <option value="21:00" <if "[task:time]".indexOf("21:00")!=-1} selected{/if}>21点00分</option>
    <option value="21:10" <if "[task:time]".indexOf("21:10")!=-1} selected{/if}>21点10分</option>
    <option value="21:20" <if "[task:time]".indexOf("21:20")!=-1} selected{/if}>21点20分</option>
    <option value="21:30" <if "[task:time]".indexOf("21:30")!=-1} selected{/if}>21点30分</option>
    <option value="21:40" <if "[task:time]".indexOf("21:40")!=-1} selected{/if}>21点40分</option>
    <option value="21:50" <if "[task:time]".indexOf("21:50")!=-1} selected{/if}>21点50分</option>
    <option value="22:00" <if "[task:time]".indexOf("22:00")!=-1} selected{/if}>22点00分</option>
    <option value="22:10" <if "[task:time]".indexOf("22:10")!=-1} selected{/if}>22点10分</option>
    <option value="22:20" <if "[task:time]".indexOf("22:20")!=-1} selected{/if}>22点20分</option>
    <option value="22:30" <if "[task:time]".indexOf("22:30")!=-1} selected{/if}>22点30分</option>
    <option value="22:40" <if "[task:time]".indexOf("22:40")!=-1} selected{/if}>22点40分</option>
    <option value="22:50" <if "[task:time]".indexOf("22:50")!=-1} selected{/if}>22点50分</option>
    <option value="23:00" <if "[task:time]".indexOf("23:00")!=-1} selected{/if}>23点00分</option>
    <option value="23:10" <if "[task:time]".indexOf("23:10")!=-1} selected{/if}>23点10分</option>
    <option value="23:20" <if "[task:time]".indexOf("23:20")!=-1} selected{/if}>23点20分</option>
    <option value="23:30" <if "[task:time]".indexOf("23:30")!=-1} selected{/if}>23点30分</option>
    <option value="23:40" <if "[task:time]".indexOf("23:40")!=-1} selected{/if}>23点40分</option>
    <option value="23:50" <if "[task:time]".indexOf("23:50")!=-1} selected{/if}>23点50分</option>
    </select>
    </td>
  </tr>
  <tr>               
    <td align='right'>是否启用:</td>
    <td>
      <input type="radio" name="Isenable" value="0"<if "[task:Isenable]"=="0">checked{/if}>不启用
      <input type="radio" name="Isenable" value="1"<if "[task:Isenable]"=="1">checked{/if}>启用
    </td>
  </tr>
  <tr>               
    <td align='right'>简要说明:</td>
    <td>
      <textarea id="Remark" style="width:350px;height:80px" >[task:Remark]</textarea>
    </td>
  </tr>
  <tr>               
    <td></td>
    <td>
		 <input type="button" value="保存设置" class="pn" onClick="return(CheckForm())">
    </td>
  </tr>
  </r:task>
</table>
<script> 
$(document).ready(function()
{
 $("#starttype").change(function()
 {
	 if($(this).val()==2)
	{
	 $("#weekarea").show();
	}else{
	 $("#weekarea").hide();
	}
	if($(this).val()==3)
	{
	 $("#time").attr("multiple","multiple");
	 $("#time").attr("style","width:200px;height:150px");
	}else{
	 $("#time").removeAttr("multiple");
	 $("#time").removeAttr("style");
	}
 });
});
 
 
function CheckForm()
{
	let TaskName,TaskURL,starttype,week,time,Isenable,Remark,sql,html
	TaskName=$("#TaskName").val()
   if(TaskName=='')
   {
     alert('请输入任务名称!');
	 	 $("#TaskName").focus();
	 	 return false
   }
	 TaskURL=$("#TaskURL").val()
	 starttype=$("#starttype").val()
	 week=$("#week").val()
	 time=$("#time").val()
	 Isenable=$("[name='Isenable']:checked").val()
	 Remark=$("#Remark").val()
   sql = ":Name='" + TaskName + "',:URL='" + TaskURL + "',:starttype=" + starttype + ",:week='" + week + "',:time='" + time + "',:Isenable='" + Isenable + "',:Remark='" + Remark + "'"
   sql = "update @.Task set " + sql + " where @.id=<.arr(4)/>"
   html = "<pres><r: tag=\"sql\">"+sql+"</r:>恭喜,定时任务修改成功!</pres>"
	 html=$.ajax({type:"POST",url:"exe.html?"+Math.random(),data:{data:escape(html)},async:false}).responseText;
	 alert(html)
	 location.reload();
   return true;
}
</script>

