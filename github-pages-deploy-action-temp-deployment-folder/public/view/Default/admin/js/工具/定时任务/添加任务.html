<div class="m-2 shadow p-2 bg-white rounded">
  <load admin/html/头部.html/>
<table class='tb'>
  <tr>               
  <td align='right'>任务名称:</td>
  <td><input type="text" id="TaskName" value="" size="50"> 如:定时生成首页</td>
  </tr>
  <tr>               
    <td align='right'>可执行任务:</td>
    <td>
    <input type="text" id="TaskURL" value="" size="100"><br/>
    如:admin/Default.aspx
    </td>
  </tr>
  <tr>               
    <td align='right'>执行周期:</td>
    <td>
    <select id="starttype" >
    <option value="1" selected>每天</option>
    <option value="2">每周</option>
    <option value="3">按时间段</option>
    </select>
    <span id="weekarea" style='display:none'>
    <select id="week" >
    <option value="1">星期一</option>
    <option value="2">星期二</option>
    <option value="3">星期三</option>
    <option value="4">星期四</option>
    <option value="5">星期五</option>
    <option value="6">星期六</option>
    <option value="7">星期日</option>
    </select> 
    </span>
    </td>
  </tr>
  <tr>               
    <td align='right'>执行时间:</td>
    <td>
    <select id="time" >
    <option value="0:00">0点00分</option><option value="0:10">0点10分</option><option value="0:20">0点20分</option><option value="0:30">0点30分</option><option value="0:40">0点40分</option><option value="0:50">0点50分</option><option value="1:00">1点00分</option><option value="1:10">1点10分</option><option value="1:20">1点20分</option><option value="1:30">1点30分</option><option value="1:40">1点40分</option><option value="1:50">1点50分</option><option value="2:00">2点00分</option><option value="2:10">2点10分</option><option value="2:20">2点20分</option><option value="2:30">2点30分</option><option value="2:40">2点40分</option><option value="2:50">2点50分</option><option value="3:00">3点00分</option><option value="3:10">3点10分</option><option value="3:20">3点20分</option><option value="3:30">3点30分</option><option value="3:40">3点40分</option><option value="3:50">3点50分</option><option value="4:00">4点00分</option><option value="4:10">4点10分</option><option value="4:20">4点20分</option><option value="4:30">4点30分</option><option value="4:40">4点40分</option><option value="4:50">4点50分</option><option value="5:00">5点00分</option><option value="5:10">5点10分</option><option value="5:20">5点20分</option><option value="5:30">5点30分</option><option value="5:40">5点40分</option><option value="5:50">5点50分</option><option value="6:00">6点00分</option><option value="6:10">6点10分</option><option value="6:20">6点20分</option><option value="6:30">6点30分</option><option value="6:40">6点40分</option><option value="6:50">6点50分</option><option value="7:00">7点00分</option><option value="7:10">7点10分</option><option value="7:20">7点20分</option><option value="7:30">7点30分</option><option value="7:40">7点40分</option><option value="7:50">7点50分</option><option value="8:00">8点00分</option><option value="8:10">8点10分</option><option value="8:20">8点20分</option><option value="8:30">8点30分</option><option value="8:40">8点40分</option><option value="8:50">8点50分</option><option value="9:00">9点00分</option><option value="9:10">9点10分</option><option value="9:20">9点20分</option><option value="9:30">9点30分</option><option value="9:40">9点40分</option><option value="9:50">9点50分</option><option value="10:00">10点00分</option><option value="10:10">10点10分</option><option value="10:20">10点20分</option><option value="10:30">10点30分</option><option value="10:40">10点40分</option><option value="10:50">10点50分</option><option value="11:00">11点00分</option><option value="11:10">11点10分</option><option value="11:20">11点20分</option><option value="11:30">11点30分</option><option value="11:40">11点40分</option><option value="11:50">11点50分</option><option value="12:00">12点00分</option><option value="12:10">12点10分</option><option value="12:20">12点20分</option><option value="12:30">12点30分</option><option value="12:40">12点40分</option><option value="12:50">12点50分</option><option value="13:00">13点00分</option><option value="13:10">13点10分</option><option value="13:20">13点20分</option><option value="13:30">13点30分</option><option value="13:40">13点40分</option><option value="13:50">13点50分</option><option value="14:00">14点00分</option><option value="14:10">14点10分</option><option value="14:20">14点20分</option><option value="14:30">14点30分</option><option value="14:40">14点40分</option><option value="14:50">14点50分</option><option value="15:00">15点00分</option><option value="15:10">15点10分</option><option value="15:20">15点20分</option><option value="15:30">15点30分</option><option value="15:40">15点40分</option><option value="15:50">15点50分</option><option value="16:00">16点00分</option><option value="16:10">16点10分</option><option value="16:20">16点20分</option><option value="16:30">16点30分</option><option value="16:40">16点40分</option><option value="16:50">16点50分</option><option value="17:00">17点00分</option><option value="17:10">17点10分</option><option value="17:20">17点20分</option><option value="17:30">17点30分</option><option value="17:40">17点40分</option><option value="17:50">17点50分</option><option value="18:00">18点00分</option><option value="18:10">18点10分</option><option value="18:20">18点20分</option><option value="18:30">18点30分</option><option value="18:40">18点40分</option><option value="18:50">18点50分</option><option value="19:00">19点00分</option><option value="19:10">19点10分</option><option value="19:20">19点20分</option><option value="19:30">19点30分</option><option value="19:40">19点40分</option><option value="19:50">19点50分</option><option value="20:00">20点00分</option><option value="20:10">20点10分</option><option value="20:20">20点20分</option><option value="20:30">20点30分</option><option value="20:40">20点40分</option><option value="20:50">20点50分</option><option value="21:00">21点00分</option><option value="21:10">21点10分</option><option value="21:20">21点20分</option><option value="21:30">21点30分</option><option value="21:40">21点40分</option><option value="21:50">21点50分</option><option value="22:00">22点00分</option><option value="22:10">22点10分</option><option value="22:20">22点20分</option><option value="22:30">22点30分</option><option value="22:40">22点40分</option><option value="22:50">22点50分</option><option value="23:00">23点00分</option><option value="23:10">23点10分</option><option value="23:20">23点20分</option><option value="23:30">23点30分</option><option value="23:40">23点40分</option><option value="23:50">23点50分</option>
    </select>
    </td>
  </tr>
  <tr>               
    <td align='right'>是否启用:</td>
    <td>
      <input type="radio" name="Isenable" value="0">不启用
      <input type="radio" name="Isenable" value="1" checked="checked">启用
    </td>
  </tr>
  <tr>               
    <td align='right'>简要说明:</td>
    <td>
    <textarea id="remark" style="width:350px;height:80px" ></textarea>
    </td>
  </tr>
  <tr>               
    <td></td>
    <td>
      <input type="button" value="添加定时任务" class="pn" onClick="CheckForm()">
    </td>
  </tr>
</table>
<script language="javascript">
$(document).ready(function()
{
   $("#starttype").change(function()
   {
     if($(this).val()==2)
	  {
	   $("#weekarea").show();
	  }else{
	   $("#weekarea").hide();
	  }
	  if($(this).val()==3)
	  {
	   $("#time").attr("multiple","multiple");
	   $("#time").attr("style","width:200px;height:150px");
	  }else{
	   $("#time").removeAttr("multiple");
	   $("#time").removeAttr("style");
	  }
   });
});
function CheckForm()
{
	let TaskName=$("#TaskName").val()
	if(TaskName=='')
	{
		alert('请输入任务名称!');
		$("#TaskName").focus();
	}
	else
	{
		let sql="insert into @.Task(@.name,:URL,:starttype,:week,:time,:Isenable,:Remark) values ('"+TaskName+"','"+$("#TaskURL").val()+"','"+$("#starttype").val()+"','"+$("#week").val()+"','"+$("#time").val()+"',"+$("[name='Isenable']:checked").val()+",'"+$("#remark").val()+"')"
  	let html = "<pres><r: tag=\"sql\">"+sql+"</r:>恭喜,定时任务添加成功!</pres>"
	 html=$.ajax({type:"POST",url:"exe.html?"+Math.random(),data:{data:escape(html)},async:false}).responseText;
	 alert(html)
	 location.reload();
	
	}
}
</script></div>
<template admin/html/通用模板.html/>
